## How to start

Download the dataset files stored at `gs://sentiment-analysis-240222` with the following make target:

```shell
make pull
```

Create a virtual environment to install the python dependencies:

```bash
python3.8 -m venv .venv
```

Then, enter into the virtual environment shell:

```bash
source .venv/bin/activate
```

So, you can install the dependencies:

```bash
pip install \
    --no-cache-dir \
    --requirements ./requirements.txt
```

# Compute engine deployment

The following steps presents how to deploy a virtual machine as a development environment for this application. First, you must install Terraform and provide you Google Cloud credentials. Then, change the project name and region in the `gcp/compute/variables.tf`:

```hcl
variable "project" {
  default = "weather-297102"
}

variable "region" {
  default = "us-central1"
}

variable "zone" {
  default = "us-central1-c"
}
```

So, create a bucket to be used to store the states generated by Terraform:

```shell
make tf-backend
```

Finally, init, plan and apply the Terraform resources as the following:

```shell
terraform init gcp/compute
terraform plan gcp/compute
terraform apply gcp/compute
```

The external IP of the virtual machine created can be found by listing the compute instances of your project, as the following command:

```shell
gcloud compute instances list
```

To continue with the deployment, you must enter into the shell command line of the virtual machine:

```shell
gcloud compute ssh sentiment-analysis-instance
```

With the virtual machine up, you can clone this repository and run the `scripts/install-dependencies.sh` script. It will install jupyter lab and their dependencies. Also, a service is created to auto start the jupyter lab server at port 80:

```shell
git clone https://github.com/himewel/sentiment-analysis
cd sentiment-analysis
sudo bash ./scripts/install-dependencies.sh
```

Then, you can repeat the step at the *How to start* section and then start the application server:

```shell
sudo python3 src/application.py
```
